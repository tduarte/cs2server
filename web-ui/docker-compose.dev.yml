services:
  backend:
    build:
      context: .
      dockerfile: Dockerfile.dev
    container_name: cs2-web-ui-backend-dev
    environment:
      # Connect to CS2 server - use 'cs2-server' if CS2 is in Docker, 'host.docker.internal' if on host
      - RCON_HOST=${RCON_HOST:-host.docker.internal}
      - RCON_PORT=${RCON_PORT:-27015}
      - RCON_PASSWORD=${RCON_PASSWORD:-oscria}
      - PORT=3001
      - NODE_ENV=development
    ports:
      - 3001:3001
    volumes:
      - ./src/backend:/app/src/backend
      - ./src/shared:/app/src/shared
      - ./package.json:/app/package.json
    working_dir: /app
    command: npm run dev:backend
    restart: unless-stopped
    networks:
      - cs2-dev-network
      # Uncomment to connect to CS2 server network if CS2 is running in Docker
      # - cs2-network

  frontend:
    build:
      context: .
      dockerfile: Dockerfile.dev
    container_name: cs2-web-ui-frontend-dev
    environment:
      - VITE_API_URL=http://localhost:3001
      - NODE_ENV=development
    ports:
      - 3000:5173
    volumes:
      - ./src/frontend:/app/src/frontend
      - ./index.html:/app/index.html
      - ./vite.config.js:/app/vite.config.js
      - ./tailwind.config.js:/app/tailwind.config.js
      - ./postcss.config.js:/app/postcss.config.js
      - ./package.json:/app/package.json
    working_dir: /app
    command: npm run dev:frontend
    depends_on:
      - backend
    restart: unless-stopped
    networks:
      - cs2-dev-network

networks:
  cs2-dev-network:
    driver: bridge
  # Optional: Connect to CS2 server network if CS2 is running in Docker
  # Uncomment and update network name if needed (default: cs2server_cs2-network)
  # cs2-network:
  #   external: true
  #   name: cs2server_cs2-network

